<!DOCTYPE html>
<!-- Blank Comment -->
<html>
  <style type="text/css">

	p.header {background-color:rgb(210,210,210); font: 12pt arial; position:absolute; left:0px; top:-16px; padding-top:10px;
			 width:100%; padding-bottom:10px}
	div.searchbar {position:absolute; left:30%; width:40%; height:33px; top:80px; border-style:solid; border-width:3px; border-radius:20px; color:rgb(211,211,211)}
	div.searchbar:focus-within {border-width:3px; color:rgb(240,120,0)}
	p.footer {background-color:rgb(0,0,110); color:white; font: 12pt arial; position:absolute; left:0px; bottom:-16px; padding-top:10px;
                         width:100%; padding-bottom:10px; text-align:center}
	a.silent:link {color:white; text-decoration:none}
	a.silent:visited {color:white; text-decoration:none}
	button.icon {position:relative; border-style:none; background-color:white; opacity:0.5; left:8px; top:2px; height:28px; width:30px}
	button.icon:hover {opacity:1.0; text-decoration:none}
	img.icon {height:28px; width:28px; position:relative; left:0px}
	span.canvas {display:inline-block; height:2in; width:2.3in; background-color:rgb(114, 160, 193); border: thick solid white; white-space:normal}
	span.canvas:hover {background-color:rgb(60, 80, 100) !important;}
	#searchbar {position:relative; left:10px; top:-10px; width:83% ; height:28px; border-style:none; }
	#searchbar:focus {outline:none}
	#loadSignTop {position:absolute; top:100px; left:47%; z-index:-1; visibility:hidden}
	#loadSignBottom {position:absolute; top:350px; left:47%; z-index:-1; visibility:hidden}
	#noResSign {position:absolute; top:120px; left:31%; visibility:hidden; background-color:rgb(211,211,211); border-radius:20px;
							padding-left:1cm; padding-right:1cm; padding-top: 10px; padding-bottom:10px; font: 16px arial;
									text-align:center; width:33%}
	#imgBlock {position:absolute; top:160px; left:24%; width:8in; height:2.2in; overflow-x:auto !important;
							visibility:hidden; white-space:nowrap;}
	#bioBlock {position:absolute; top:400px; left:0%; width:100%; visibility:hidden}

  </style>

  <script>

	function sendQuery(){

				xhttp = new XMLHttpRequest();
				noResSign.style.visibility = "hidden";
				delete prevCanvasId;
				firstLine.innerHTML = "";
				secondLine.innerHTML = "";
				thirdLine.innerHTML = "";
				a=imgBlock.innerHTML;

				if (imgBlock.innerHTML == "" || a.charCodeAt(0) == 10){
						loadSignTop.style.visibility = "visible";
					}else {
						loadSignBottom.style.visibility = "visible";};

				query = searchbar.value;
				xhttp.open("POST", "https://vardges-testrun12.oa.r.appspot.com/namequery/"+query)
				xhttp.send();

				xhttp.onload = function() {

					if (xhttp.responseText == "NoResults"){
								imgBlock.style.visibility = "hidden";
								imgBlock.innerHTML = "";
								bioBlock.style.visibility = "hidden";
								loadSignTop.style.visibility = "hidden";
								loadSignBottom.style.visibility = "hidden";
								noResSign.style.visibility = "visible";
					}else {
								noResSign.style.visibility = "hidden";
								loadSignTop.style.visibility = "hidden";
								loadSignBottom.style.visibility = "hidden";
								imgBlock.style.visibility = "visible";
								imgBlock.innerHTML = "";
								bioBlock.style.visibility = "visible";

								renderImages( JSON.parse(xhttp.response) );

					};

							};

										};


	function renderImages(rawData){

				imgString = rawData.img_refs;
				imgRefsArray = imgString.split("{}");

				titleString = rawData.titles;
				titleArray = titleString.split("{}");

				idString = rawData.ids;
				idArray = idString.split("{}");

				for (ind=0; ind<(imgRefsArray.length-1); ind++){

					canvas = document.createElement("span");
					canvas.className = "canvas";
					canvas.id = idArray[ind];

					canvas.addEventListener("click", function(){ displayBio(this.id); });
					imgBlock.appendChild(canvas);

					img = document.createElement("img");
					img.src = imgRefsArray[ind];
					img.style.borderRadius = "50%";
					img.style.border = "thick solid white";
					img.style.height = "1.2in";
					img.style.width = "1.2in";
					img.style.margin = "10px 0px 0px 48px";

					div = document.createElement("div");
					div.innerHTML = titleArray[ind];
					div.style.position = "relative";
					div.style.top = "1.7in";
					div.style.width = "100%";
					div.style.textAlign = "center";
					div.style.color = "white";
					div.style.font = "12px arial";

					canvas.appendChild(div);
					canvas.appendChild(img);

						};

								};


	function displayBio(currCanvasId){

				loadSignBottom.style.visibility = "visible";
				currCanvas = document.getElementById(currCanvasId);
				currCanvas.style.backgroundColor = "rgb(60, 80, 100)";
				firstLine.innerHTML = "";
				secondLine.innerHTML = "";
				thirdLine.innerHTML = "";

				if (typeof(prevCanvasId) == 'string' && prevCanvasId != currCanvasId){
					prevCanvas = document.getElementById(prevCanvasId);
					prevCanvas.style.backgroundColor = "rgb(114, 160, 193)";
																};
				prevCanvasId = currCanvasId;

				artistId = currCanvasId;
				ind = parseInt(currCanvasId);
				var xhttp = new XMLHttpRequest();
				xhttp.open("POST", "https://vardges-testrun12.oa.r.appspot.com/idquery/"+artistId)
				xhttp.send();

				xhttp.onload = function() {

					loadSignBottom.style.visibility = "hidden";

					rawData = JSON.parse(xhttp.response);
					nameArtist = rawData.name;
					dateArtist = "(" + rawData.birthday + " - " + rawData.deathday + ")";
					nationArtist = rawData.nationality;
					biographyArtist = rawData.biography;

					firstLine.innerHTML = nameArtist + " " + dateArtist;
					secondLine.innerHTML = nationArtist;
					thirdLine.innerHTML = biographyArtist;

				};

							};

	function clearSearchbar(){ 
					document.getElementById("searchbar").value='';
											 };


  </script>

  <body>

	<div>
	  <p class="header"> &ensp; Artist Search  </p>
	</div>

	<div class="searchbar"> <form id="searchForm" onSubmit="sendQuery(); return false"; autocomplete="off">
	  <button type="submit" id="leftButton" class="icon" > <img class="icon" src="search_icon.png"> </button>
	  <input type="text" id="searchbar" name="searchbar" placeholder="Please enter an artist name." required/>
	  <button type="button" class="icon" onclick="clearSearchbar()"> <img class="icon" src="clear_icon.png"> </button>
	</form></div>

	<div id="loadSignTop">
		<img src="loading.gif" style="height:75px; width:75px">
	</div>

	<p id="noResSign">
		No results found.
	</p>

	<div id="imgBlock">
	</div>

	<div id="loadSignBottom">
		<img src="loading.gif" style="height:75px; width:75px">
	</div>

	<div id="bioBlock" >
		<p id="firstLine" style="font:14px arial; font-weight: bold; text-align:center; left:0px; width:100%"></p>
		<p id="secondLine" style="font:14px arial; font-weight: bold; text-align:center; left:0px; width:100%"></p>
		<p id="thirdLine" style="font:14px arial; text-align:justify; position:absolute; left:10%; width:80%"></p>
	</div>

	<div>
	  <p class="footer"> Powered by <img src="artsy_logo.svg" style="height:13px; width:13px">  <a href="https://www.artsy.net/" class="silent"> Artsy </a> </p>
	</div>
		
	
  </body>
</html>
